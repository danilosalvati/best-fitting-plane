{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 96d9495d9f7f39bf58e3","webpack:///./src/index.js","webpack:///./src/LSE.js","webpack:///./node_modules/svd-js/build-umd/svd-js.min.js"],"names":["points","Array","TypeError","length","forEach","point","Object","isNaN","x","y","z","allYEquals","prevY","i","meanCoordinates","pointsArray","xs","ys","zs","xMean","yMean","zMean","means","pointsNormalized","index","SVD","v","normalize","A","B","C"],"mappings":"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","file":"best-fitting-plane.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"BestFittingPlane\"] = factory();\n\telse\n\t\troot[\"BestFittingPlane\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 96d9495d9f7f39bf58e3","import LSE from './LSE'\n\nexport {\n  LSE\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import {SVD} from 'svd-js'\n\n/**\n * Implementation of a Least Square Evaluation function as descripted in\n * https://www.geometrictools.com/Documentation/LeastSquaresFitting.pdf (par. 3)\n * This will return a plane in the form Ax + By + C = z\n */\n\n// TODO CHANGE COMMENT WITH THE NEW IMPLEMENTATION\nexport default (points) => {\n  // INPUT VALIDATION\n\n  // Check if the input array is well-formed\n  if (!(points instanceof Array)) {\n    throw new TypeError('This function accepts only an Array of points as input')\n  }\n\n  if (points.length < 3) {\n    throw new TypeError('You need at least three points to define a plane')\n  }\n\n  points.forEach(point => {\n    if (!(point instanceof Object)) {\n      throw new TypeError('The input should contains only points ' +\n        'with the following structure: {x:<number>, y:<number>, z:<number>}')\n    } else {\n      if (isNaN(point.x) ||\n        isNaN(point.y) ||\n        isNaN(point.z)) {\n        throw new TypeError('The input should contains only points ' +\n          'with the following structure: {x:<number>, y:<number>, z:<number>}')\n      }\n    }\n  })\n\n  // Check if all points are aligned with the y-axis\n  let allYEquals = true\n  let prevY = points[0].y\n  for (let i = 1; i < points.length && allYEquals; i++) {\n    if (points[i].y !== prevY) {\n      allYEquals = false\n    }\n  }\n\n  if (allYEquals) {\n    throw new TypeError('Unable to find a plane for vertical points')\n  }\n\n  let meanCoordinates = (pointsArray) => {\n    let xs = 0\n    let ys = 0\n    let zs = 0\n    pointsArray.forEach(point => {\n      xs += point.x\n      ys += point.y\n      zs += point.z\n    })\n\n    return {\n      xMean: xs / pointsArray.length,\n      yMean: ys / pointsArray.length,\n      zMean: zs / pointsArray.length\n    }\n  }\n\n  let means = meanCoordinates(points)\n  let pointsNormalized = []\n\n  for (let i = 0; i < points.length; i++) {\n    pointsNormalized[i] = new Array(3)\n  }\n\n  points.forEach((point, index) => {\n    pointsNormalized[index][0] = point.x - means.xMean\n    pointsNormalized[index][1] = point.y - means.yMean\n    pointsNormalized[index][2] = point.z - means.zMean\n  })\n\n  let {v} = SVD(pointsNormalized)\n\n  let normalize = -1 / v[2][2]\n\n  let A = v[0][2] * normalize\n  let B = v[1][2] * normalize\n  let C = -(means.xMean * A + means.yMean * B + means.zMean * v[2][2] * normalize)\n\n  return {A, B, C}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/LSE.js","!function(r,o){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=o():\"function\"==typeof define&&define.amd?define([],o):\"object\"==typeof exports?exports.SVDJS=o():r.SVDJS=o()}(\"undefined\"!=typeof self?self:this,function(){return function(r){function o(f){if(t[f])return t[f].exports;var e=t[f]={i:f,l:!1,exports:{}};return r[f].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var t={};return o.m=r,o.c=t,o.d=function(r,t,f){o.o(r,t)||Object.defineProperty(r,t,{configurable:!1,enumerable:!0,get:f})},o.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return o.d(t,\"a\",t),t},o.o=function(r,o){return Object.prototype.hasOwnProperty.call(r,o)},o.p=\"\",o(o.s=0)}([function(r,o,t){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0});var f=t(1),e=t(2);t.d(o,\"SVD\",function(){return f.a}),t.d(o,\"VERSION\",function(){return e.a})},function(r,o,t){\"use strict\";var f=function(r,o,t,f,e){if(o=void 0===o||o,t=void 0===t||t,f=f||Math.pow(2,-52),e=1e-64/f,!r)throw new TypeError(\"Matrix a is not defined\");var i=r[0].length,n=r.length;if(n<i)throw new TypeError(\"Invalid matrix: m < n\");var a=void 0,u=void 0,s=void 0,d=void 0,v=void 0,c=void 0,l=void 0,p=void 0,h=void 0,M=void 0,b=void 0,y=void 0,w=void 0;p=0,b=0;var x=[],q=[],m=[],j=void 0;for(a=0;a<n;a++)q[a]=new Array(i).fill(0);for(a=0;a<i;a++)m[a]=new Array(i).fill(0);for(j=new Array(i).fill(0),a=0;a<n;a++)for(u=0;u<i;u++)q[a][u]=r[a][u];for(a=0;a<i;a++){for(x[a]=p,M=0,d=a+1,u=a;u<n;u++)M+=Math.pow(q[u][a],2);if(M<e)p=0;else for(l=q[a][a],p=l<0?Math.sqrt(M):-Math.sqrt(M),h=l*p-M,q[a][a]=l-p,u=d;u<i;u++){for(M=0,s=a;s<n;s++)M+=q[s][a]*q[s][u];for(l=M/h,s=a;s<n;s++)q[s][u]=q[s][u]+l*q[s][a]}for(j[a]=p,M=0,u=d;u<i;u++)M+=Math.pow(q[a][u],2);if(M<e)p=0;else{for(l=q[a][a+1],p=l<0?Math.sqrt(M):-Math.sqrt(M),h=l*p-M,q[a][a+1]=l-p,u=d;u<i;u++)x[u]=q[a][u]/h;for(u=d;u<n;u++){for(M=0,s=d;s<i;s++)M+=q[u][s]*q[a][s];for(s=d;s<i;s++)q[u][s]=q[u][s]+M*x[s]}}y=Math.abs(j[a])+Math.abs(x[a]),y>b&&(b=y)}if(t)for(a=i-1;a>=0;a--){if(0!==p){for(h=q[a][a+1]*p,u=d;u<i;u++)m[u][a]=q[a][u]/h;for(u=d;u<i;u++){for(M=0,s=d;s<i;s++)M+=q[a][s]*m[s][u];for(s=d;s<i;s++)m[s][u]=m[s][u]+M*m[s][a]}}for(u=d;u<i;u++)m[a][u]=0,m[u][a]=0;m[a][a]=1,p=x[a],d=a}if(o)for(a=i-1;a>=0;a--){for(d=a+1,p=j[a],u=d;u<i;u++)q[a][u]=0;if(0!==p){for(h=q[a][a]*p,u=d;u<i;u++){for(M=0,s=d;s<n;s++)M+=q[s][a]*q[s][u];for(l=M/h,s=a;s<n;s++)q[s][u]=q[s][u]+l*q[s][a]}for(u=a;u<n;u++)q[u][a]=q[u][a]/p}else for(u=a;u<n;u++)q[u][a]=0;q[a][a]=q[a][a]+1}f*=b;var S=void 0;for(s=i-1;s>=0;s--)for(var O=0;O<50;O++){for(S=!1,d=s;d>=0;d--){if(Math.abs(x[d])<=f){S=!0;break}if(Math.abs(j[d-1])<=f)break}if(!S)for(c=0,M=1,v=d-1,a=d;a<s+1&&(l=M*x[a],x[a]=c*x[a],!(Math.abs(l)<=f));a++)if(p=j[a],j[a]=Math.sqrt(l*l+p*p),h=j[a],c=p/h,M=-l/h,o)for(u=0;u<n;u++)y=q[u][v],w=q[u][a],q[u][v]=y*c+w*M,q[u][a]=-y*M+w*c;if(w=j[s],d===s){if(w<0&&(j[s]=-w,t))for(u=0;u<i;u++)m[u][s]=-m[u][s];break}for(b=j[d],y=j[s-1],p=x[s-1],h=x[s],l=((y-w)*(y+w)+(p-h)*(p+h))/(2*h*y),p=Math.sqrt(l*l+1),l=((b-w)*(b+w)+h*(y/(l<0?l-p:l+p)-h))/b,c=1,M=1,a=d+1;a<s+1;a++){if(p=x[a],y=j[a],h=M*p,p*=c,w=Math.sqrt(l*l+h*h),x[a-1]=w,c=l/w,M=h/w,l=b*c+p*M,p=-b*M+p*c,h=y*M,y*=c,t)for(u=0;u<i;u++)b=m[u][a-1],w=m[u][a],m[u][a-1]=b*c+w*M,m[u][a]=-b*M+w*c;if(w=Math.sqrt(l*l+h*h),j[a-1]=w,c=l/w,M=h/w,l=c*p+M*y,b=-M*p+c*y,o)for(u=0;u<n;u++)y=q[u][a-1],w=q[u][a],q[u][a-1]=y*c+w*M,q[u][a]=-y*M+w*c}x[d]=0,x[s]=l,j[s]=b}for(a=0;a<i;a++)j[a]<f&&(j[a]=0);return{u:q,q:j,v:m}};o.a=f},function(r,o,t){\"use strict\";t.d(o,\"a\",function(){return f});var f=\"1.0.1\"}])});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/svd-js/build-umd/svd-js.min.js\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}